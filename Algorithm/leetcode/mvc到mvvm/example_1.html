<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>

  <div id="app">

  </div>
  <div id="status">

  </div>
</body>
<script>
  // 后端内容
  axios.interceptors.response.use((response)=>{
    let {config:{url,method,data}} = response
    let row = {
      id:1,
      name:'JavaScript高级程序设计',
      number:2
    }
    if(url === '/books/1' && method === 'get'){
      response.data = row
    }else if(url === '/books/1' && method === 'put'){
      reponse.data = Object.assign(row,data)
    }
    return response
  })

  function fetchDb(){
    return axios.get('/books/1')
  } 
  function saveDb(newData){
    return axios.put('/books/1',newData)
  }

  var template = `
    <div>
        书名: 《__name__》,
        数量: <span id = 'number'>__number__</span>
    </div>
    <button id = 'increaseByOne'>加1</button>
    <button id = 'decreaseByOne'>减1</button>
    <button id = 'square'>平方</button>
    <button id = 'cube'>立方</button>
    <button id = 'reset'>归零</button>
  `
  fetchDb().then((response)=>{
    let result = reponse.data
    $('#app').html(
      template.replace('__number__',result.number)
      .replace('__name__',result.name)
    )
    // 加1
    $('#increaseByOne').on('click',(e)=>{
      let oldResult = parseInt($('#number').text(),10)
      let newResult = Math.pow(oldResult,2)
      saveDb({number:newResult}).then(({data})=>{
        $('#number').text(data.number)
      })
    })
  })
</script>
</html>